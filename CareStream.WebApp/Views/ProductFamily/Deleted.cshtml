@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}


@model List<CareStream.Models.DeletedProductFamily>

@{
    ViewData["Title"] = "Dealer";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<head>

    </style>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Carestream</title>
    <!-- Bootstrap code & custom styles-->
    <link href="~/css/bootstrap.min.css" rel="stylesheet" />
    <link href="~/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
    <link href="~/style.css" rel="stylesheet" />
    <link href="~/css/offset-wizard.css" rel="stylesheet" />
    <link href="~/css/toastr.min.css" rel="stylesheet" />


    <!-- Fontawesome -->
    <script src="https://kit.fontawesome.com/e508532408.js" crossorigin="anonymous"></script>
</head>

<div id="page-content-wrapper">

    <form>
        <div id="lstgroup">

            <div class="container no-gutter border-bottom mb-4">
                <div class="row">
                    <nav class="navbar navbar-expand-lg navbar-light pt-0 pb-0">
                        <a class="navbar-brand" href="#"></a>
                        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown"
                                aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarNavDropdown">
                            <ul class="nav-tabs navbar-nav">
                                <li class="nav-item active col-6">
                                    <button type="button" class="nav-link font-weight-bold" style="cursor:pointer" value="Delete" onclick="confirmDelete(true)">
                                        <i class="fa fa-trash" aria-hidden="true"></i> Delete Permanently
                                    </button>

                                    @*<span class="sr-only">(current)</span>*@

                                    @*<button type="button" class="nav-link font-weight-bold" style="cursor:pointer" value="Delete" onclick="confirmDelete(true)">
                                            <i class="fa fa-trash" aria-hidden="true"></i> Delete Permanently
                                        </button>*@
                                </li>
                                <li class="nav-item col-3">
                                    <a id="selectedPFRestore" class="nav-link font-weight-bold" style="cursor:pointer" onclick="blockUi();">
                                        <i class="fa fa-cloud-upload" aria-hidden="true"></i> Restore
                                    </a>

                                </li>
                                <li class="nav-item col-3">
                                    <a class="nav-link font-weight-bold" href="#" id="refresh">
                                        <i class="fa fa-refresh" aria-hidden="true"></i> Refresh
                                    </a>
                                </li>
                                <li class="nav-item col-5">
                                    <a class="nav-link font-weight-bold" href="#" id="downloadgroups">
                                        <i class="fa fa-download" aria-hidden="true"></i> Download
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>

            @Html.AntiForgeryToken()
            <div class="container">
                <div class="row ">
                    <table id="example" class="table table-striped border" style="width:100%">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="selectedID1" /> </th>
                                <th>Product Family Name</th>
                                <th>Product Family Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model)
                            {
                                <tr>
                                    <td style="width:5%">

                                        <input type="checkbox" name="selectedList" id="selectedGroup" value="@item.ProductFamilyId" data-memberid="@item.ProductFamilyId" />
                                    </td>
                                    <td style="width:20%">
                                        @Html.DisplayFor(modelItem => item.ProductFamilyName)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.ProductDescription)
                                    </td>


                                </tr>
                            }

                        </tbody>
                    </table>

                </div>
            </div>

        </div>

    </form>
</div>
@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}

<script type="text/javascript">

        $(document).ready(function () {
            $('#selectedPFRestore').on('click', function () {
            var selectedPFIds = [];
                $("input[type='checkbox'][id^='selectedGroup']:checked").each(function () { selectedPFIds.push($(this).data("memberid")); })

            $.ajax({
                type: "POST",
                url: '@Url.Action("RestoreProductFamily", "ProductFamily")',
                contentType: 'application/json; charset=utf-8',
                dataType: "json",
                cache: false,
                beforeSend: function (xhr) {
                    xhr.setRequestHeader("XSRF-TOKEN",
                        $('input:hidden[name="__RequestVerificationToken"]').val());
                },
                data: JSON.stringify({
                    selectedProductFamily: selectedPFIds
                }),
                success: function (response) {

                },
                failure: function (response) {
                    alert(response);
                }
            })
        });

            $('#example').DataTable({
                "language": {
                    "search": "",
                    "searchPlaceholder": "Search product Family",
                },
                "bLengthChange": false,
                "fixedHeader": {
                    "footer": false
                },
                //"dom": "<'#searchid'f>trip"
            });


            $('#refresh').on('click', function () {
                window.location.reload();
            });

            unBlockUi();
        });

        function confirmDelete(isDelete) {

            $('#Controller').val('ProductFamily');
            $('#Action').val('DeleteProductFamilyPermanenttly');

            if (isDelete) {
                $('#confirmDialog').show('fade');
            } else {
                $('#confirmDialog').hide();
                unBlockUi();
            }

        }


</script>
}